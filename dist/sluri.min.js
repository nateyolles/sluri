/*! sluri - v0.4.0 - 2016-08-06
* https://github.com/nateyolles/sluri
* Copyright (c) 2016 Nate Yolles; Licensed Apache-2.0 */
!function(a,b){"use strict";"function"==typeof define&&define.amd?define(b):"object"==typeof module&&module.exports?module.exports=b():a.slURI=b()}(this,function(){"use strict";function a(a){return encodeURI(a).replace(/%5B/g,"[").replace(/%5D/g,"]")}function b(a){return encodeURIComponent(a).replace(/[!'()*]/g,function(a){return"%"+a.charCodeAt(0).toString(16)})}function c(a){var c,d,e=[];if(a){c=(f+a).replace("?",""),d=c.split("&");for(var g=0;g<d.length;g++){var h=d[g].split("=");e.push({key:h[0],value:h[1]||f})}}this.toString=function(){for(var a=[],c=0;c<e.length;c++)a.push(b(e[c].key)+"="+b(e[c].value));return a.length>0?a.join("&"):f},this.toLocaleString=function(){return this.toString()},this.has=function(a){for(var b=0;b<e.length;b++)if(e[b].key===a)return!0;return!1},this.get=function(a){for(var b=0;b<e.length;b++)if(e[b].key===a)return e[b].value;return null},this.getAll=function(a){for(var b=[],c=0;c<e.length;c++)e[c].key===a&&b.push(e[c].value);return b},this.delete=function(a){for(var b=0;b<e.length;b++)e[b].key===a&&e.splice(b,1)},this.append=function(a,b){e.push({key:a,value:b})},this.set=function(a,b){for(var c=0,d=0;d<e.length;d++)e[d].key===a&&(c?e.splice(d,1):e[d].value=b,c++);0===c&&this.append(a,b)},this.keys=function(){for(var a=[],b=0;b<e.length;b++)a.push(e[b].key);return a},this.values=function(){for(var a=[],b=0;b<e.length;b++)a.push(e[b].value);return a}}function d(b){var c=[];b&&(c=b.split(".")),this.toString=function(){return a(c.join("."))},this.toLocaleString=function(){return this.toString()},this.has=function(a){return c.indexOf(a)!==-1},this.append=function(a){c.push(a)},this.delete=function(a){var b=c.indexOf(a);b!==-1&&c.splice(b,1)},this.values=function(){return c}}var e=1,f="",g="Failed to construct 'URL': Invalid URL",h=function(b,i){function j(a){return/^[a-zA-Z][a-zA-Z0-9+\.-]+:\/\//.test(a)}function k(a){return a instanceof h||"undefined"!=typeof Location&&a instanceof Location||"undefined"!=typeof HTMLAnchorElement&&a instanceof HTMLAnchorElement||"undefined"!=typeof URL&&a instanceof URL}function l(a){for(var b=a%256,c=3;c>0;c--)a=Math.floor(a/256),b=a%256+"."+b;return b}function m(a){var b,c="/",d="/",e="",f="",g="";return a&&(a=""+a,0!==a.indexOf("/")&&(a="/"+a),b=a.split("."),d=b[0],e=b.slice(1,b.length-1).join("."),f=b[b.length-1].split("/")[0],b.length>=2?(g=b[b.length-1].split("/").slice(1).join("/"),g=g?"/"+g:"",c=d+"."+(e&&e+".")+f):(b=a.split("/"),c=b.length>2?b[1]:a)),{pathname:c,resourcePath:d,selectorString:e,extension:f,suffix:g}}function n(a){var b,c,d,e,f,g,h,i,j,k,l,n;return b=new RegExp(/^(?:(?:(([^:\/#\?]+:)?(?:(?:\/\/)(?:(?:(?:([^:@\/#\?]+)(?:\:([^:@\/#\?]*))?)@)?(([^:\/#\?]+|\[[^\/\]@#?]+\])(?:\:([0-9]+))?))?)?)?((?:\/?(?:[^\/\?#]+\/+)*)(?:[^\?#]*)))?(\?[^#]+)?)(#.*)?/),c=b.exec(a),d=c[1]||"",e=c[2]||"",f=c[3]||"",g=c[4]||"",h=c[6]||"",i=c[7]||"",j=c[8]||"",k=c[9]||"",l=c[10]||"",n=m(j),{protocol:e,username:f,password:g,hostname:h,port:i,origin:d,pathname:n.pathname,resourcePath:n.resourcePath,selectorString:n.selectorString,extension:n.extension,suffix:n.suffix,search:k,hash:l}}function o(b){C.protocol=b.protocol,C.username=b.username,C.password=b.password,C.hostname=b.hostname,C.port=b.port,w=a(b.resourcePath),C.selectorString=b.selectorString,y=a(b.extension),C.suffix=b.suffix,C.search=b.search,C.hash=b.hash}function p(){var a,c;if("string"==typeof b?0===b.indexOf("/")?i&&(k(i)?a=i.origin:(c=n(i),a=c.hostname&&c.origin),a&&(b=a+b,q=n(b))):j(b)&&(q=n(b)):k(b)&&(q=n(b.href)),!q)throw new TypeError(g)}var q,r,s,t,u,v,w,x,y,z,A,B,C=this;if(!(this instanceof h))throw new TypeError("Failed to construct 'slURI': Please use the 'new' operator, this DOM object constructor cannot be called as a function.");if(arguments.length<e)throw new TypeError("Failed to construct 'URL': "+e+" argument required, but only "+arguments.length+" present.");Object.defineProperties(this,{protocol:{enumerable:!0,configurable:!0,get:function(){return r||f},set:function(a){a&&/^[a-zA-Z][a-zA-Z0-9+\.-]+:?$/.test(a)&&(r=":"===a.substr(-1)?a:a+":")}},username:{enumerable:!0,configurable:!0,get:function(){return s||f},set:function(b){s=a(f+b)}},password:{enumerable:!0,configurable:!0,get:function(){return t||f},set:function(b){t=a(f+b)}},hostname:{enumerable:!0,configurable:!0,get:function(){return u||f},set:function(b){b&&(u=isNaN(b)?a(b.split(":")[0]):l(b))}},host:{enumerable:!0,configurable:!0,get:function(){var a=u||f;return v&&(a+=":"+v),a},set:function(a){if(a){var b=a.split(":"),c=b[0],d=b[1];this.hostname=c,d&&(this.port=d)}}},port:{enumerable:!0,configurable:!0,get:function(){return v||f},set:function(a){null!==a&&void 0!==a&&(a===f?v=a:("number"==typeof a||/^\d+(\.\d+)?$/.test(a))&&(v=f+parseInt(a,10)))}},origin:{enumerable:!0,configurable:!0,get:function(){return this.protocol+"//"+this.host},set:function(){}},pathname:{enumerable:!0,configurable:!0,get:function(){var a;return w&&"/"!==w&&(a=w,this.selectorString&&(a+="."+this.selectorString),y&&(a+="."+y)),a||"/"},set:function(b){var c;c=m(b),w=a(c.resourcePath),y=a(c.extension),this.selectorString=c.selectorString}},resourcePath:{enumerable:!0,configurable:!0,get:function(){return w},set:function(b){null!==b&&void 0!==b&&(w=a(b))}},selectorString:{enumerable:!0,configurable:!0,get:function(){return this.selectors.toString()},set:function(a){null!==a&&void 0!==a&&(this.selectors=new d(a))}},selectors:{enumerable:!0,configurable:!0,get:function(){return x},set:function(a){a instanceof d&&(x=a)}},extension:{enumerable:!0,configurable:!0,get:function(){return y||""},set:function(b){y&&b&&(y=a(b))}},suffix:{enumerable:!0,configurable:!0,get:function(){return z},set:function(b){null!==b&&void 0!==b&&(z=a(b))}},search:{enumerable:!0,configurable:!0,get:function(){var a=A.toString();return a?"?"+a:f},set:function(a){null!==a&&void 0!==a&&(A=new c(a))}},searchParams:{enumerable:!0,configurable:!0,get:function(){return A},set:function(a){a instanceof c&&(A=a)}},hash:{enumerable:!0,configurable:!0,get:function(){return B||f},set:function(a){B=a?0===a.indexOf("#")?a:"#"+a:f}},href:{enumerable:!0,configurable:!0,get:function(){var a=[];return a.push(this.protocol+"//"),a.push(this.username),a.push(this.password&&":"+this.password),a.push((this.username||this.password)&&"@"),a.push(this.host),a.push(this.pathname),a.push(this.suffix),a.push(this.search),a.push(this.hash),a.join("")},set:function(a){a&&(q=n(a),o(q))}}}),p(),o(q)};return h.prototype.toString=function(){return this.href},h.prototype.toLocaleString=function(){return this.href},h});